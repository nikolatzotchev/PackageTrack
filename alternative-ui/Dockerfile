# This file is autogenerated - modifications will be lost
FROM nginx:1.12

# Build the application
COPY . /tmp/
WORKDIR /tmp
RUN apt-get update && \
    apt-get install -y --no-install-recommends --no-install-suggests gnupg wget && \
    wget http://deb.nodesource.com/setup_8.x -O /tmp/node_setup.sh && \
    bash /tmp/node_setup.sh && \
    apt-get -y install nodejs && \
    echo "^^^^^^^^ Building the application..." \
    cd /tmp && \
    npm install && \
    ./node_modules/.bin/ng build -prod --progress=false --output-path=/usr/share/nginx/html && \
    echo "^^^^^^^^ Setting up nginx..." && \
    cp nginx.conf /etc/nginx/conf.d/default.conf && \
    echo "^^^^^^^^ Cleaning up..." && \
    apt-get -u --purge remove -y nodejs gnupg wget && \
    apt-get autoremove -y && \
    apt-get clean && \
    rm -rf /tmp/*
